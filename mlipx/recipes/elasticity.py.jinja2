import mlipx
import zntrack

from models import MODELS


project = zntrack.Project()

{% if n_samples %}
print(f"Elasticity benchmark on {n_samples} mp-ids")
{% else %}
n_samples = 10
print(f"Elasticity benchmark on {n_samples} mp-ids")
{% endif %}

elasticity_dict = {}
elasticity_list = []

for model_name, model in MODELS.items():
    with project.group(model_name):
        benchmark = mlipx.Elasticity(
            model =model,
            model_name=model_name,
            n_samples=n_samples,
        )
        elasticity_dict[model_name] = benchmark
        elasticity_list.append(benchmark)


project.build()